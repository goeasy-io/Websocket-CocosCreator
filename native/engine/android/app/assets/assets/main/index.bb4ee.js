System.register("chunks:///_virtual/GameManager.ts",["cc","./PlayerController.ts"],(function(e){"use strict";var t,i,r,n,a,s,l,o,u,c;return{setters:[function(e){t=e.cclegacy,i=e.Prefab,r=e.CCInteger,n=e.Node,a=e.Label,s=e._decorator,l=e.Component,o=e.Vec3,u=e.instantiate},function(e){c=e.PlayerController}],execute:function(){var h,b,p,d,y,g,S,f,T,_,P,R,v;function w(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function E(e,t,i,r,n){var a={};return Object.keys(r).forEach((function(e){a[e]=r[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),a),n&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}t._RF.push({},"326d6DtDjZPxJ4SwTMVuYAe","GameManager",void 0);const{ccclass:G,property:N}=s;var m,C;!function(e){e[e.BT_NONE=0]="BT_NONE",e[e.BT_STONE=1]="BT_STONE"}(m||(m={})),function(e){e[e.GS_INIT=0]="GS_INIT",e[e.GS_PLAYING=1]="GS_PLAYING",e[e.GS_RESTART=2]="GS_RESTART"}(C||(C={}));e("GameManager",(h=G("GameManager"),b=N({type:i}),p=N({type:r}),d=N({type:n}),y=N({type:c}),g=N({type:a}),h((T=E((f=class extends l{constructor(...e){var t,i,r;super(...e),w(this,"cubePrfb",T,this),w(this,"roadLength",_,this),r=[],(i="_road")in(t=this)?Object.defineProperty(t,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[i]=r,w(this,"startMenu",P,this),w(this,"playerCtrl",R,this),w(this,"stepsLabel",v,this)}start(){var e;this.subscribe(),this.curState=C.GS_INIT,null===(e=this.playerCtrl)||void 0===e||e.node.on("JumpEnd",this.onPlayerJumpEnd,this)}subscribe(){window.goEasy.pubsub.subscribe({channel:"PlayerStatus",onMessage:e=>{switch(e.content){case"RESTART":this.curState=C.GS_RESTART;break;case"PLAYING":this.curState=C.GS_PLAYING}},onSuccess:()=>{console.log("监听PlayerStatus新消息成功")},onFailed:e=>{console.log("订阅消息失败, code:"+e.code+",错误信息:"+e.content)}})}sendMessage(e){let t=e;window.goEasy.pubsub.publish({channel:"PlayerStatus",message:t,onSuccess:()=>{console.log("发送成功")},onFailed:e=>{console.log("消息发送失败，错误编码："+e.code+" 错误信息："+e.content)}})}init(){this.startMenu&&(this.startMenu.active=!1),this.generateRoad(),this.playerCtrl&&(this.playerCtrl.node.setPosition(o.ZERO),this.playerCtrl.reset())}reStart(){this.startMenu&&(this.startMenu.active=!0),this.generateRoad(),this.playerCtrl&&(this.playerCtrl.node.setPosition(o.ZERO),this.playerCtrl.reset())}set curState(e){switch(e){case C.GS_INIT:this.init();break;case C.GS_PLAYING:this.startMenu&&(this.startMenu.active=!1),this.stepsLabel&&(this.stepsLabel.string="0");break;case C.GS_RESTART:this.reStart()}}generateRoad(){this._road=[1,0,1,1,0,1,1,1,1,0,1,0,1,0,1,0,1,1,1,1,1,0,1,0,1,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,1];let e=0;for(let t=0;t<this._road.length;t++)this._road[t]&&++e,0==this._road[t]&&e>0&&(this.spawnBlockByCount(t-1,e),e=0),this._road.length==t+1&&e>0&&(this.spawnBlockByCount(t,e),e=0)}spawnBlockByCount(e,t){let i=this.spawnBlockByType(m.BT_STONE);i&&(this.node.addChild(i),null==i||i.setScale(t,1,1),null==i||i.setPosition(e-.5*(t-1),-1.5,0))}spawnBlockByType(e){if(!this.cubePrfb)return null;let t=null;switch(e){case m.BT_STONE:t=u(this.cubePrfb)}return t}onStartButtonClicked(){this.sendMessage("PLAYING")}checkResult(e){e<this.roadLength?this._road[e]==m.BT_NONE&&this.sendMessage("RESTART"):this.sendMessage("RESTART")}onPlayerJumpEnd(e){this.stepsLabel&&(this.stepsLabel.string=""+(e>=this.roadLength?this.roadLength:e)),this.checkResult(e)}}).prototype,"cubePrfb",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=E(f.prototype,"roadLength",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),P=E(f.prototype,"startMenu",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=E(f.prototype,"playerCtrl",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=E(f.prototype,"stepsLabel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=f))||S));t._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerController.ts",["cc","./goeasy.min.js","./goeasy.min.mjs_cjs=&original=.js"],(function(e){"use strict";var t,i,s,n,o,r;return{setters:[function(e){t=e.cclegacy,i=e.Animation,s=e._decorator,n=e.Component,o=e.Vec3},function(e){r=e.default},function(){}],execute:function(){var c,u,a,l,d;function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}t._RF.push({},"ddfb1tkyx9BEqyM7xmfE5Db","PlayerController",void 0);const{ccclass:h,property:m}=s,_=r.getInstance({host:"hangzhou.goeasy.io",appkey:"BC-1e46fd20681e42ccb085c22219c395bf",modules:["pubsub"]});window.GoEasy=r,window.goEasy=_;e("PlayerController",(c=h("PlayerController"),u=m({type:i}),c((d=function(e,t,i,s,n){var o={};return Object.keys(s).forEach((function(e){o[e]=s[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=i.slice().reverse().reduce((function(i,s){return s(e,t,i)||i}),o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}((l=class extends n{constructor(...e){super(...e),function(e,t,i,s){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(s):void 0})}(this,"BodyAnim",d,this),p(this,"_startJump",!1),p(this,"_jumpStep",0),p(this,"_curJumpTime",0),p(this,"_jumpTime",.3),p(this,"_curJumpSpeed",0),p(this,"_curPos",new o),p(this,"_deltaPos",new o(0,0,0)),p(this,"_targetPos",new o),p(this,"_curMoveIndex",0)}start(){_.connect({id:"player",data:{},onSuccess:()=>{console.log("GoEasy connect successfully."),this.subscribe()},onFailed:e=>{console.log("Failed to connect GoEasy, code:"+e.code+",error:"+e.content)},onProgress:e=>{console.log("GoEasy is connecting",e)}})}onClickButton(e){"LeftButton"===e.currentTarget._name?this.sendMessage(1):"RightButton"===e.currentTarget._name&&this.sendMessage(2)}subscribe(){_.pubsub.subscribe({channel:"mindYourStep",onMessage:e=>{let t=JSON.parse(e.content);this.jumpByStep(t.step)},onSuccess:()=>{console.log("监听新消息成功")},onFailed:e=>{console.log("订阅消息失败, code:"+e.code+",错误信息:"+e.content)}})}sendMessage(e){let t={step:e,content:`player跳了${e}步`};_.pubsub.publish({channel:"mindYourStep",message:JSON.stringify(t),onSuccess:()=>{console.log("发送成功")},onFailed:e=>{console.log("消息发送失败，错误编码："+e.code+" 错误信息："+e.content)}})}reset(){this._curMoveIndex=0}jumpByStep(e){this._startJump||(this._startJump=!0,this._jumpStep=e,this._curJumpTime=0,this._curJumpSpeed=this._jumpStep/this._jumpTime,this.node.getPosition(this._curPos),o.add(this._targetPos,this._curPos,new o(this._jumpStep,0,0)),this.BodyAnim&&(1===e?this.BodyAnim.play("oneStep"):2===e&&this.BodyAnim.play("twoStep")),this._curMoveIndex+=e)}onOnceJumpEnd(){this.BodyAnim&&this.BodyAnim.play("cocos_anim_idle"),this.node.emit("JumpEnd",this._curMoveIndex)}update(e){this._startJump&&(this._curJumpTime+=e,this._curJumpTime>this._jumpTime?(this.node.setPosition(this._targetPos),this._startJump=!1,this.onOnceJumpEnd()):(this.node.getPosition(this._curPos),this._deltaPos.x=this._curJumpSpeed*e,o.add(this._curPos,this._curPos,this._deltaPos),this.node.setPosition(this._curPos)))}}).prototype,"BodyAnim",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a=l))||a));t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./PlayerController.ts","./GameManager.ts"],(function(){"use strict";return{setters:[function(){},function(){}],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});